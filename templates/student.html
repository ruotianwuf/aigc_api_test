<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>STUDENT</title>
    <link rel="stylesheet" href="../static/css/student.css">
</head>
<body>
    <div class="container">
        <h1>一体化在线教育社区系统_学生端</h1>
        <button class="Register_button" onclick="register()">注册</button>
        <button class="Login_button" onclick="login()" id="student_login">登录</button>
        <nav>
            <ul>
                <li><button onclick="go_advice()">建议</button></li>
                <li><button onclick="go_courses()">课程</button></li>
                <li><button onclick="go_forum()">论坛</button></li>
                <li><button onclick="go_grades()">成绩</button></li>
            </ul>
        </nav>
        <br>
    </div>
</body>

<script>
     var urlParams = new URLSearchParams(window.location.search);
     var receivedData = urlParams.get('data');
     var cookieName = "student";
     var cookieValue = receivedData;
     document.cookie = cookieName + "=" + cookieValue;

    function checkCookie(cookieName) {
    // 获取所有的 Cookie，并以分号加空格进行分割
    var cookies = document.cookie.split("; ");

    // 遍历所有 Cookie
    for (var i = 0; i < cookies.length; i++) {
        // 分割每个 Cookie 的键值对
        var cookiePair = cookies[i].split("=");

        // 检查当前 Cookie 是否为目标 Cookie
        if (cookiePair[0] === cookieName && cookiePair[1] === cookieValue) {
            // 如果找到目标 Cookie，返回 true
            return cookieValue;
        }
    }

    // 如果未找到目标 Cookie，则返回 false
    return false;
}


     var myCookieValue = checkCookie("student");
     if (myCookieValue){
         // alert(myCookieValue);
         var cookieString ='<div>'+'欢迎你,'+myCookieValue+'</div>';
         // alert(cookieString);
         document.getElementById("student_login").innerHTML = cookieString;

     }

     function go_advice(){
         var ck=checkCookie('student');
         // alert(cookieValue);
         if(ck==cookieValue){
             // alert(ck);
             window.location.href="/student/advice";

         }else{
             alert("请先登录");
             window.location.href="/login/student";
         }
     }
     function go_courses(){
         var ck=checkCookie('student');
         // alert(cookieValue);
         if(ck==cookieValue){
             // alert(ck);
             window.location.href="/student/course";
         }else{
             alert("请先登录");
             window.location.href="/login/student";
         }
     }
     function go_forum(){
         var ck=checkCookie('student');
         // alert(cookieValue);
         if(ck==cookieValue){
             // alert(ck);
             window.location.href="http://127.0.0.1:5000/student/forum";
         }else{
             alert("请先登录");
             window.location.href="/login/student";
         }
     }
     function go_grades(){
         var ck=checkCookie('student');
         // alert(cookieValue);
         if(ck==cookieValue){
             // alert(ck);
             window.location.href="/student/grades";
         }else{
             alert("请先登录");
             window.location.href="/login/student";
         }
     }
     function login(){
         var ck=checkCookie('student');
         // alert(cookieValue);
         if(ck==cookieValue){
             // alert(ck);
         }else{
             alert("请先登录");
             window.location.href="/login/student";
         }
     }

     document.addEventListener("DOMContentLoaded",function (){
         var ck = checkCookie('student');
         if (ck == cookieValue) {
             var registerButton = document.querySelector('.Register_button');
             registerButton.classList.add('hidden');
         }
     });
</script>
</html>
